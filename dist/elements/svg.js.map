{"version":3,"sources":["../../src/elements/svg.js"],"names":["React","require","SVG","props","lastTransformation","x","y","isDragging","handleMouseDown","bind","handleMouseMove","handleMouseUp","e","target","nodeName","parentNode","getAttribute","clickPosition","pageX","pageY","transform","animVal","matrix","f","targetBaseWidth","targetRealWidth","width","baseVal","value","getBoundingClientRect","multiplier","parseFloat","toFixed","xDiff","yDiff","setAttribute","height","fill","children","Component","propTypes","PropTypes","number","isRequired","string","defaultProps","module","exports"],"mappings":"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","file":"svg.js","sourcesContent":["const React = require('react');\n\nclass SVG extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.lastTransformation = {\n      x: 0,\n      y: 0\n    };\n\n    this.isDragging = false;\n\n    this.handleMouseDown = this.handleMouseDown.bind(this);\n    this.handleMouseMove = this.handleMouseMove.bind(this);\n    this.handleMouseUp = this.handleMouseUp.bind(this);\n  }\n\n  handleMouseDown(e) {\n    if(e.target.nodeName === 'tspan') {\n      e.target = e.target.parentNode;\n    }\n\n    if(e.target.getAttribute('data-draggable')) {\n      this.isDragging = e.target;\n\n      this.clickPosition = {\n        x: e.pageX,\n        y: e.pageY\n      }\n\n      const transform = this.isDragging.transform;\n    \n      const x = transform.animVal[0].matrix.e;\n      const y = transform.animVal[0].matrix.f;\n\n      this.lastTransformation = {\n        x: x,\n        y: y\n      };\n    } else {\n      this.isDragging = false;\n    }\n  }\n\n  handleMouseMove(e) {\n    if(this.isDragging) {\n      let targetBaseWidth,\n          targetRealWidth;\n\n      try {\n        targetBaseWidth = this.isDragging.width.baseVal.value;\n        targetRealWidth = this.isDragging.getBoundingClientRect().width;\n      } catch(e) {\n        targetBaseWidth = 1;\n        targetRealWidth = 1;\n      }\n\n      const multiplier = parseFloat((targetBaseWidth / targetRealWidth).toFixed(2));\n      const xDiff = ((e.pageX - this.clickPosition.x) * multiplier) + this.lastTransformation.x;\n      const yDiff = ((e.pageY - this.clickPosition.y) * multiplier) + this.lastTransformation.y;\n      const matrix = 'matrix(1 0 0 1 ' + xDiff + ' ' + yDiff + ')';\n\n      this.isDragging.setAttribute('transform', matrix);\n    }\n  }\n\n  handleMouseUp(e) { \n    if(this.isDragging) {\n      const transform = this.isDragging.transform;\n    \n      const x = transform.animVal[0].matrix.e;\n      const y = transform.animVal[0].matrix.f;\n\n      this.isDragging = false;\n\n      this.lastTransformation = {\n        x: 0,\n        y: 0\n      };\n\n    }\n  }\n\n  render() {\n    const { height, width, fill, children } = this.props;\n\n    return (\n      <svg height=\"100%\"\n           width=\"100%\"\n           onMouseDown={this.handleMouseDown}\n           onMouseMove={this.handleMouseMove}\n           onMouseUp={this.handleMouseUp}\n           viewBox={'0 0 ' + width + ' ' + height}>\n\n        <rect x=\"0\" y=\"0\" width={width} height={height} fill={fill} />\n        \n        {children}\n      </svg>\n      );\n  }\n\n}\n\n// Prop types\nSVG.propTypes = {\n  height: React.PropTypes.number.isRequired,\n  width: React.PropTypes.number.isRequired,\n  fill: React.PropTypes.string.isRequired\n};\n\nSVG.defaultProps = {\n  height: 400,\n  width: 600,\n  fill: 'transparent'\n}\n\nmodule.exports = SVG;"]}